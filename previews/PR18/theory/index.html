<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mixed Layer Theory · MixedLayerModel.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MixedLayerModel.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Mixed Layer Theory</a><ul class="internal"><li><a class="tocitem" href="#Bulk-boundary-layers"><span>Bulk boundary layers</span></a></li><li><a class="tocitem" href="#Cloud-top-entrainment"><span>Cloud-top entrainment</span></a></li><li><a class="tocitem" href="#Radiation"><span>Radiation</span></a></li><li><a class="tocitem" href="#Cloud-Fraction"><span>Cloud Fraction</span></a></li><li><a class="tocitem" href="#Thermodynamics"><span>Thermodynamics</span></a></li></ul></li><li><a class="tocitem" href="../ode_solver/">ODE Solver</a></li><li><a class="tocitem" href="../exp/">CO<span>$_2$</span> Perturbation Experiment</a></li><li><a class="tocitem" href="../results_fixSST/">Fixed SST Results</a></li><li><a class="tocitem" href="../results_slab/">Slab Ocean Results</a></li><li><a class="tocitem" href="../library/">APIs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Mixed Layer Theory</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Mixed Layer Theory</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/claresinger/MixedLayerModel.jl/blob/main/docs/src/theory.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Mixed-Layer-Theory"><a class="docs-heading-anchor" href="#Mixed-Layer-Theory">Mixed Layer Theory</a><a id="Mixed-Layer-Theory-1"></a><a class="docs-heading-anchor-permalink" href="#Mixed-Layer-Theory" title="Permalink"></a></h1><h2 id="Bulk-boundary-layers"><a class="docs-heading-anchor" href="#Bulk-boundary-layers">Bulk boundary layers</a><a id="Bulk-boundary-layers-1"></a><a class="docs-heading-anchor-permalink" href="#Bulk-boundary-layers" title="Permalink"></a></h2><p>The mixed-layer model (MLM) is based on the assumption that the boundary layer between the surface and inversion height <span>$z_i$</span> is well-mixed. With these assumptions the governing equations simplify to a set of coupled ODEs for the inversion height and two thermodynamic variables for the energy and the water in the system.</p><p>The two thermodynamic quantities (<span>$\psi$</span>) we use are <span>$h = C_p T + gz + L_v q_v$</span>, the moist static energy, and <span>$q_t = q_v + q_l$</span>, the total water specific humidity. Fig. 1 shows a sketch of the profiles of moist static energy, total water specific humidity, relative humidity, and liquid water specific humidity from the surface into the free-troposphere. The cloud is indicated by the grey shading between altitudes <span>$z_b$</span> (diagnosed as the <a href="#Lifting-condensation-level,-cloud-base">lifting condensation level</a>) and <span>$z_i$</span> where relative humidity is equal to 100%.</p><p><img src="../figures/mlm-diagram-with-ql.png" alt/> Fig. 1. Sketch of the vertical profiles of <span>$\psi_1$</span> and <span>$\psi_2$</span>. The grey shading denotes where the cloud layer is predicted to form.</p><p>The temporal evolution of these is governed by a balance between turbulent fluxes at the surface and across the inversion, and a diabatic source term <span>$\Delta F_\psi$</span>.</p><p><span>$z_i \frac{d\psi_{M}}{dt} = V (\psi_0 - \psi_{M} ) + w_e (\psi_+ - \psi_{M}) - \Delta F_\psi$</span></p><p>The prognostic equation for inversion height is found by vertically integrating the continuity equation. </p><p>We extend the traditional MLM from e.g. <a href="https://doi.org/10.1175/1520-0469(1997)054&lt;0148:MTLTSA&gt;2.0.CO;2">Bretherton and Wyant (1997)</a> to couple it to a slab ocean to ensure a closed surface energy budget and a simple radiation scheme that includes the effects of CO_2 on cloud-top radiative cooling. We also add a prognostic equation for cloud fraction.</p><p>The sea surface temperature (SST) is found by a enforcing a closed surface energy budget. In this model we neglect precipitation (<span>$\Delta F_{q_t} = 0$</span>).</p><p class="math-container">\[\begin{aligned} 
    \frac{dz_i}{dt} &amp;= w_e - Dz_i \\ 
    z_i \frac{dh_M}{dt} &amp;= V (h_0 - h_{M}) + w_e (h_+ - h_{M}) - \Delta R / \rho \\ 
    z_i \frac{dq_{tM}}{dt} &amp;= V (q_{t0} - q_{tM}) + w_e (q_{t+} - q_{tM}) \\ 
    C \frac{dSST}{dt} &amp;= (1-\alpha) \frac{S_0}{4} - LW_{net} - \rho V (h_0 - h_M) - OHU \\
    \frac{dCF}{dt} &amp;= \frac{CF&#39; - CF}{\tau_{CF}} 
\end{aligned}\]</p><p>To close these equations we must specify the <a href="#Cloud-top-entrainment">cloud-top entrainment velocity</a> (<span>$w_e$</span>) and the <a href="#Radiation">cloud-top radiative cooling</a> (<span>$\Delta R$</span>) as well as the functional form for the <a href="#Cloud-Fraction">cloud fraction</a>.</p><h2 id="Cloud-top-entrainment"><a class="docs-heading-anchor" href="#Cloud-top-entrainment">Cloud-top entrainment</a><a id="Cloud-top-entrainment-1"></a><a class="docs-heading-anchor-permalink" href="#Cloud-top-entrainment" title="Permalink"></a></h2><p>There are two choices for the entrainment parameterization in this mixed-layer model.</p><h3 id="Energy-balance-entrainment"><a class="docs-heading-anchor" href="#Energy-balance-entrainment">Energy balance entrainment</a><a id="Energy-balance-entrainment-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-balance-entrainment" title="Permalink"></a></h3><p>The first assumes that the entrainment velocity is such as to satisfy a steady-state energy balance.</p><p><span>$w_e = \frac{\Delta R / \rho_{ref}}{\Delta_i s_{vl}}$</span></p><h3 id="Buoyancy-flux-entrainment"><a class="docs-heading-anchor" href="#Buoyancy-flux-entrainment">Buoyancy flux entrainment</a><a id="Buoyancy-flux-entrainment-1"></a><a class="docs-heading-anchor-permalink" href="#Buoyancy-flux-entrainment" title="Permalink"></a></h3><p>This alternative described by <a href="https://doi.org/10.1175/1520-0469(1997)054&lt;0148:MTLTSA&gt;2.0.CO;2">Bretherton and Wyant (1997)</a> as the &#39;&#39;minimal&#39;&#39; model calculates the entrainment velocity as being proportional to the average sub-cloud buoyancy flux and inversely proportional to the buoyancy jump across the inversion.</p><p><span>$w_e = \frac{2.5 A \overline{\langle w&#39; s_v&#39; \rangle}}{\Delta_i s_v}$</span></p><p>where <span>$s_v$</span> is the virtual dry static energy. </p><p>This is solved via the method described in Appendix A of <a href="https://doi.org/10.1175/1520-0469(1997)054&lt;0148:MTLTSA&gt;2.0.CO;2">Bretherton and Wyant (1997)</a> by splitting the buoyancy flux into two parts and solving each integral analytically and then inverting. </p><h2 id="Radiation"><a class="docs-heading-anchor" href="#Radiation">Radiation</a><a id="Radiation-1"></a><a class="docs-heading-anchor-permalink" href="#Radiation" title="Permalink"></a></h2><h3 id="Surface-energy-balance"><a class="docs-heading-anchor" href="#Surface-energy-balance">Surface energy balance</a><a id="Surface-energy-balance-1"></a><a class="docs-heading-anchor-permalink" href="#Surface-energy-balance" title="Permalink"></a></h3><p>The surface energy budget equation can be written as,</p><p><span>$\frac{d SST}{dt} = SW^{down} - SW^{up} + LW^{down} - LW^{up}- LHF - SHF - OHU.$</span></p><p>We write the shortwave terms as <span>$SW_{net} = (1 - \alpha_{cloud})(1 - \alpha_{ocean}) \frac{S_0}{4}$</span></p><p>We approximate the net longwave radiation as constant <span>$LW_{net} = -30$</span> W/m<span>$^2$</span>.</p><p>Or we write the net longwave radiation as the difference of two blackbody terms</p><p><span>$LW_{net} = \sigma (SST - t)^4 - \sigma SST^4$</span></p><p>where <span>$t$</span> is proportional to the mixed-layer specific humidity because as the air becomes  more moist, the effective emission level gets closer to the surface. We use a  simple fit to LES data and write, <span>$t = 500 \cdot qM$</span> where <span>$qM$</span> is in kg/kg. </p><h4 id="Cloud-shortwave-albedo"><a class="docs-heading-anchor" href="#Cloud-shortwave-albedo">Cloud shortwave albedo</a><a id="Cloud-shortwave-albedo-1"></a><a class="docs-heading-anchor-permalink" href="#Cloud-shortwave-albedo" title="Permalink"></a></h4><p><span>$\alpha_{cloud} = 1 - \frac{L_{1/2}}{L_{1/2} + LWP}$</span></p><p>where <span>$L_{1/2}$</span> is the <a href="#Liquid-water-path">liquid water path (LWP)</a> value such that <span>$\alpha_{cloud} = 0.5$</span>. This is based on <a href="https://doi.org/10.1175/1520-0469(1978)035&lt;2123:RPIEWC&gt;2.0.CO;2">Stephens (1978b)</a> equations 1 and 7.  We can write <span>$L_{1/2} = \frac{2 \mu r_e}{3 \beta}$</span> where <span>$\mu = \cos\theta$</span> is the cosine of the solar zenith angle,  <span>$r_e$</span> is the droplet effective radius, and <span>$\beta$</span> is the backscatter coefficient. We take <span>$\beta = 0.07$</span> from Table 2, <span>$\theta = 60^\circ$</span>, and <span>$r_e = 10$</span> <span>$\mu$</span>m, which yields a value of <span>$L_{1/2} \approx 71$</span> g/m<span>$^2$</span>.</p><p>Alternatively, the cloud albedo can be parameterized empirically based on the LES results from <a href="https://doi.org/10.1038/s41561-019-0310-1">Schneider et al. (2019)</a> as,</p><p><span>$\alpha_{cloud} = a \left( 1 - \frac{L_{1/2}}{L_{1/2} + LWP} \right)$</span></p><p>where <span>$a = 0.795$</span> and <span>$L_{1/2} = 19.136$</span> g/m<span>$^2$</span>.</p><h3 id="Cloud-top-longwave-cooling"><a class="docs-heading-anchor" href="#Cloud-top-longwave-cooling">Cloud-top longwave cooling</a><a id="Cloud-top-longwave-cooling-1"></a><a class="docs-heading-anchor-permalink" href="#Cloud-top-longwave-cooling" title="Permalink"></a></h3><p>The amount of longwave cooling at the cloud top is dependent on the infrared energy radiating up from the cloud and the infrared energy radiating back down from higher in the atmosphere.</p><p><span>$\Delta R = \epsilon_{cloud} \sigma T(z_i)^4 - \sigma T_{eff}^4$</span></p><h4 id="Effective-emissions-temperature-of-downwelling-longwave-radiation-to-cloud-top"><a class="docs-heading-anchor" href="#Effective-emissions-temperature-of-downwelling-longwave-radiation-to-cloud-top">Effective emissions temperature of downwelling longwave radiation to cloud-top</a><a id="Effective-emissions-temperature-of-downwelling-longwave-radiation-to-cloud-top-1"></a><a class="docs-heading-anchor-permalink" href="#Effective-emissions-temperature-of-downwelling-longwave-radiation-to-cloud-top" title="Permalink"></a></h4><p><span>$T_{eff} = a_0 + a_1 \ln \left( \frac{CO_2}{400} \right) = 263.5 + 10.8 \ln \left( \frac{CO_2}{400} \right)$</span></p><p>This is an empirical fit to the LES results from <a href="https://doi.org/10.1038/s41561-019-0310-1">Schneider et al. (2019)</a>. </p><h4 id="Cloud-longwave-emissivity"><a class="docs-heading-anchor" href="#Cloud-longwave-emissivity">Cloud longwave emissivity</a><a id="Cloud-longwave-emissivity-1"></a><a class="docs-heading-anchor-permalink" href="#Cloud-longwave-emissivity" title="Permalink"></a></h4><p><span>$\epsilon_{cloud} = 1 - \exp(-LWP/L_\tau)$</span></p><p>where <span>$LWP_\tau = 7$</span> g/m<span>$^2$</span> is the optical thickness of the cloud. This is based on <a href="https://doi.org/10.1175/1520-0469(1978)035&lt;2123:RPIEWC&gt;2.0.CO;2">Stephens (1978b)</a> equations 15 and 16, taking an intermediate value of the parameter <span>$a_0 = 0.15$</span>.</p><h2 id="Cloud-Fraction"><a class="docs-heading-anchor" href="#Cloud-Fraction">Cloud Fraction</a><a id="Cloud-Fraction-1"></a><a class="docs-heading-anchor-permalink" href="#Cloud-Fraction" title="Permalink"></a></h2><p>We parameterize the cloud fraction as a function of the stability parameter (aka decoupling parameter), <span>$S = \left( \frac{LHF}{\Delta R} \right) \left( \frac{z_i - z_b}{z_i} \right)$</span>, inspired by <a href="https://doi.org/10.1175/JCLI-D-11-00105.1">Chung and Teixeira (2012)</a>.</p><p>Specifically, we use a smooth function  <span>$CF = 1 - \frac{0.8}{1 + exp(-m(S-S_{crit}))}$</span>  where <span>$m=10$</span> is a tunable parameter that sets the strength of the nonlinear feedback and <span>$S_{crit}=0.7$</span> is the value of the stability parameter that corresponds to <span>$CF=0.6$</span>, the halfway point of the transition. The theoretical limit for the stability threshold, where decoupling occurs is at <span>$S \approx 0.55$</span>.</p><p><img src="../figures/cf-vs-s.png" alt/></p><h2 id="Thermodynamics"><a class="docs-heading-anchor" href="#Thermodynamics">Thermodynamics</a><a id="Thermodynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Thermodynamics" title="Permalink"></a></h2><h3 id="Saturation-adjustment"><a class="docs-heading-anchor" href="#Saturation-adjustment">Saturation adjustment</a><a id="Saturation-adjustment-1"></a><a class="docs-heading-anchor-permalink" href="#Saturation-adjustment" title="Permalink"></a></h3><p>The liquid water specific humidity is determined according to a standard saturation adjustment procedure. Simply, the mass of condensed water is the excess total water specific humidity exceeding the saturation specific humidity. </p><p>In this mixed-layer model, all thermodynamic equations are written in terms of moist static energy <span>$h$</span> and total water specific humidity <span>$q_t$</span>. The temperature then is calculated implicitly by requiring that </p><p><span>$h = C_p T + gz + L_0 q_v$</span>.</p><h3 id="Lifting-condensation-level,-cloud-base"><a class="docs-heading-anchor" href="#Lifting-condensation-level,-cloud-base">Lifting condensation level, cloud base</a><a id="Lifting-condensation-level,-cloud-base-1"></a><a class="docs-heading-anchor-permalink" href="#Lifting-condensation-level,-cloud-base" title="Permalink"></a></h3><p>The cloud base is calculated as the lifting condensation level (LCL), which is a thermodynamic property depending only on the mixed-layer properties. The LCL is defined as the altitude <span>$z_b$</span> such that,</p><p><span>$q_{tM} - q_{sat}(z, T(z, h_M, q_{tM})) = 0.$</span></p><h3 id="Liquid-water-path"><a class="docs-heading-anchor" href="#Liquid-water-path">Liquid water path</a><a id="Liquid-water-path-1"></a><a class="docs-heading-anchor-permalink" href="#Liquid-water-path" title="Permalink"></a></h3><p>The liquid water path is the mass of condensed liquid water along a vertical path through the cloud, i.e.</p><p><span>$LWP = \int_{z_b}^{z_i} \rho q_l(z) dz$</span></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../ode_solver/">ODE Solver »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 11 November 2022 00:08">Friday 11 November 2022</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
